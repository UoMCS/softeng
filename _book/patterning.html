<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Software design patterns | Software engineering</title>
<meta name="author" content="Suzanne Embury and the software engineering team">
<meta name="description" content="9.1 Introduction In this workshop, we will look at design patterns, and their application in refactoring. A software design pattern describes a general, reusable solution to a commonly occurring...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 9 Software design patterns | Software engineering">
<meta property="og:type" content="book">
<meta property="og:url" content="https://software-eng.netlify.app/patterning.html">
<meta property="og:description" content="9.1 Introduction In this workshop, we will look at design patterns, and their application in refactoring. A software design pattern describes a general, reusable solution to a commonly occurring...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Software design patterns | Software engineering">
<meta name="twitter:site" content="@csmcr">
<meta name="twitter:description" content="9.1 Introduction In this workshop, we will look at design patterns, and their application in refactoring. A software design pattern describes a general, reusable solution to a commonly occurring...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-GJ4FGSK01L"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-GJ4FGSK01L');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Software engineering</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="expectations.html">Expectations</a></li>
<li><a class="" href="timetabling.html">Weekly timetable</a></li>
<li class="book-part">Weekly Workshops</li>
<li><a class="" href="building.html"><span class="header-section-number">1</span> Building and testing</a></li>
<li><a class="" href="understanding.html"><span class="header-section-number">2</span> Large systems</a></li>
<li><a class="" href="debugging.html"><span class="header-section-number">3</span> Debugging</a></li>
<li><a class="" href="estimating.html"><span class="header-section-number">4</span> Cost estimation</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">5</span> Test first development</a></li>
<li><a class="" href="flowing.html"><span class="header-section-number">6</span> Git workflows</a></li>
<li><a class="" href="refactoring.html"><span class="header-section-number">7</span> Software Refactoring</a></li>
<li><a class="" href="designing.html"><span class="header-section-number">8</span> Design for Testability</a></li>
<li><a class="active" href="patterning.html"><span class="header-section-number">9</span> Software design patterns</a></li>
<li><a class="" href="risking.html"><span class="header-section-number">10</span> Risk management</a></li>
<li><a class="" href="opening.html"><span class="header-section-number">11</span> Open source challenge</a></li>
<li class="book-part">Team study materials</li>
<li><a class="" href="starting.html"><span class="header-section-number">12</span> Starting Stendhal</a></li>
<li><a class="" href="mentoring.html"><span class="header-section-number">13</span> Industrial mentoring</a></li>
<li><a class="" href="ourmentor.html"><span class="header-section-number">14</span> Your mentor</a></li>
<li><a class="" href="syncing.html"><span class="header-section-number">15</span> Synchronising</a></li>
<li class="book-part">Coursework</li>
<li><a class="" href="gitting.html"><span class="header-section-number">16</span> Individual Coursework 1</a></li>
<li><a class="" href="conflicting.html"><span class="header-section-number">17</span> Individual Coursework 2</a></li>
<li><a class="" href="dealing.html"><span class="header-section-number">18</span> Team Coursework 1</a></li>
<li><a class="" href="working.html"><span class="header-section-number">19</span> Team Coursework 2</a></li>
<li class="book-part">Self study materials</li>
<li><a class="" href="guiding.html"><span class="header-section-number">20</span> Testing Stendhal</a></li>
<li><a class="" href="committing.html"><span class="header-section-number">21</span> Integrating commits</a></li>
<li><a class="" href="integrating.html"><span class="header-section-number">22</span> Continuous integration</a></li>
<li><a class="" href="reviewing.html"><span class="header-section-number">23</span> Code review</a></li>
<li><a class="" href="automating.html"><span class="header-section-number">24</span> Unit testing</a></li>
<li><a class="" href="reading.html"><span class="header-section-number">25</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/dullhunk/softeng">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="patterning" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Software design patterns<a class="anchor" aria-label="anchor" href="#patterning"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h2>
<p>In this workshop, we will look at design patterns, and their application in refactoring. A software design pattern describes a general, reusable solution to a commonly occurring problem in a specific design context. They’re often useful when designing new pieces of software as they both allow us to reuse best practice from prior experience, and provide a means to discuss the design with others (a shared vocabulary). However, design patterns can be equally useful when refactoring existing codebases.</p>
<p>The workshop builds on techniques given in previous workshops for working with large codebases, in particular extending those in Workshop 8 for refactoring existing code. In this workshop you will:</p>
<ul>
<li>Be introduced to 6 of the 23 <a href="https://en.wikipedia.org/wiki/Design_Patterns">Gang of Four (GoF) Design Patterns</a> <span class="citation">(<a href="reading.html#ref-GoF" role="doc-biblioref">Gamma et al. 1994</a>)</span>
</li>
<li>Refactor a small existing code base to apply Behavioural, Structural and Creational patterns</li>
</ul>
<p>We’ll be assuming that, after this workshop, you are capable of carrying out the following tasks for yourself, without needing much guidance:</p>
<ul>
<li>Identify portions of existing codebases that could be improved through the application of Design Patterns</li>
<li>Describe a refactoring using a design pattern vocabulary and, where appropriate, supporting UML</li>
<li>Apply design patterns to an existing codebase</li>
</ul>
<p>As in prior workshops, there will be scope to work through the tasks at your own pace – in particular, each of the three workshop exercises is divided into multiple stages that address first one design pattern, and then a second. You should (at a minimum) aim to have completed all tasks related to the first design pattern of each exercise.</p>
</div>
<div id="behave" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Workshop Exercise 1 - Behavioural Patterns<a class="anchor" aria-label="anchor" href="#behave"><i class="fas fa-link"></i></a>
</h2>
<p>This first section of the workshop focuses on applying the two Behavioural patterns introduced: Strategy, and State.</p>
<p>For this exercise, you’ll be working with a small-scale Java codebase that’s loosely inspired by some classes in the Stendhal codebase. For this first exercise you’ll be focussing on a set of classes that represent pets. The main classes and their members can be represented in a UML class diagram shown in figure <a href="patterning.html#fig:basicpets-fig">9.1</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:basicpets-fig"></span>
<img src="images/BasicPets.png" alt="Pets, Cats, Goats and Magic Dragons" width="100%"><p class="caption">
Figure 9.1: Pets, Cats, Goats and Magic Dragons
</p>
</div>
<p>In this workshop you’ll be extending and then refactoring the codebase to explore how behavioural patterns can simplify the process of adding new functionality, and can remove the need for duplicate code.</p>
<div id="strategy" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Exercise 1a - The Strategy Pattern<a class="anchor" aria-label="anchor" href="#strategy"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of the exercise we’ll be focusing on the Strategy pattern. You will modify the code in five stages:</p>
<ul>
<li>Add a new <code>Pet</code> class <code>CuddlyToy</code> that requires new algorithms for the growth, feeding, hunger, and crying.</li>
<li>Consider how one might use sub-class/super-class relationships to avoid duplicate code.</li>
<li>Implement an abstract <code>GrowthStrategy</code> that provides method signatures for growth-related algorithms.</li>
<li>Implement the three concrete implementations of <code>GrowthStrategy</code> encountered so far.</li>
<li>Modify the existing <code>Pet</code> classes to use the newly created strategy classes.</li>
</ul>
<div id="pet" class="section level4" number="9.2.1.1">
<h4>
<span class="header-section-number">9.2.1.1</span> Stage 1 - Add a new Pet class<a class="anchor" aria-label="anchor" href="#pet"><i class="fas fa-link"></i></a>
</h4>
<p>You’ve been asked to add a new Pet, <code>CuddlyToy</code>, for players that (for example) have allergies or just don’t want the effort of looking after a real-life creature. The requirements for <code>CuddlyToy</code> are as follows:</p>
<ul>
<li>A <code>CuddlyToy</code> should not grow, they are <code>ADULT_SIZE</code> at instantiation.</li>
<li>A <code>CuddlyToy</code> does not eat, and should not get hungry.</li>
<li>A <code>CuddlyToy</code> squeaks, its cry is generated by a plastic squeaker</li>
</ul>
<p><strong><code>[ACTION]</code></strong> Implement a new <code>Pet</code> subclass that complies with the above requirements, and modify <code>PetDriver.java</code> to demonstrate your new Pet subtype.</p>
</div>
<div id="stage-2---design-sub-classsuper-class-relationships-to-avoid-duplicated-code" class="section level4" number="9.2.1.2">
<h4>
<span class="header-section-number">9.2.1.2</span> Stage 2 - Design sub-class/super-class relationships to avoid duplicated code<a class="anchor" aria-label="anchor" href="#stage-2---design-sub-classsuper-class-relationships-to-avoid-duplicated-code"><i class="fas fa-link"></i></a>
</h4>
<p>It’s clear that many of our Pets have quite different algorithms for growth. Some, like <code>Goats</code> and <code>Cats</code> grow steadily, increasing by a fixed amount over a constant time interval. Others, like <code>MagicDragons</code>, increase by a fixed amount but at irregular intervals – their growth stagnates for a while and then they undergo a growth spurt. Some <code>Pets</code>, like <code>CuddlyToys</code>, don’t grow at all.</p>
<p>If we wanted to introduce more <code>Pet</code> types, we could quickly end up having to duplicate the code for steady, irregular or no growth across multiple <code>Pet</code> subclases. Alternatively, we could add layers of subclassing shown in figure <a href="patterning.html#fig:petsubclasses-fig">9.2</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:petsubclasses-fig"></span>
<img src="images/GrowthSubclasses.png" alt="Possible subclasses of Pet" width="100%"><p class="caption">
Figure 9.2: Possible subclasses of Pet
</p>
</div>
<p>However, this could quickly become difficult to manage, and doesn’t always avoid duplicate. For example, suppose you’re now asked to add a new <code>Bird</code> subtype. Birds can fly (like <code>Dragons</code>) but grow steadily (like <code>Cats</code> and <code>Goats</code>). The resulting class structure might look something like that shown in figure <a href="patterning.html#fig:petsubclasses2-fig">9.3</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:petsubclasses2-fig"></span>
<img src="images/GrowthSubclasses2.png" alt="A badly designed hierarchy" width="100%"><p class="caption">
Figure 9.3: A badly designed hierarchy
</p>
</div>
<p>So, we’ve now potentially duplicated our steady growth code in two superclasses <code>SteadilyGrowingGroundPet</code> and <code>SteadilyGrowingFlyingPet</code>, and some new code for flying behaviours in two superclasses <code>SteadilyGrowingFlyingPet</code> and <code>RandomlyGrowingFlyingPet</code>. This definitely isn’t great design.</p>
</div>
<div id="growthstrategy" class="section level4" number="9.2.1.3">
<h4>
<span class="header-section-number">9.2.1.3</span> Stage 3 - Introduce a GrowthStrategy<a class="anchor" aria-label="anchor" href="#growthstrategy"><i class="fas fa-link"></i></a>
</h4>
<p>A Strategy pattern defines a encapsulates a family of interchangeable algorithms – here, our interchangeable algorithms describe different patterns of growth.</p>
<p>The first step in refactoring to a Strategy will be to create an abstract class <code>GrowthStrategy</code>.</p>
<p><strong><code>[ACTION]</code></strong> Create a new <code>GrowthStrategy</code> class, with abstract method signatures for <code>canGrow()</code> and <code>Grow()</code>.</p>
</div>
<div id="growthstrategies" class="section level4" number="9.2.1.4">
<h4>
<span class="header-section-number">9.2.1.4</span> Stage 4 - Implement concrete growth strategies<a class="anchor" aria-label="anchor" href="#growthstrategies"><i class="fas fa-link"></i></a>
</h4>
<p>You now need to create concrete implementations of your <code>GrowthStrategy</code> class, each representing a different growth algorithm. So far, we’ve encountered three growth algorithms:</p>
<ul>
<li>Steady growth – Grows by a fixed amount every time the grow method is called.</li>
<li>Random growth – Grows by a fixed amount some random subset of times that the grow method is called.</li>
<li>No growth – Does not grow, even when the grow method is called.</li>
</ul>
<p><strong><code>[ACTION]</code></strong> Create three subclass implementations of <code>GrowthStrategy</code>, one for each of the growth algorithms encountered so far.</p>
</div>
<div id="modifys" class="section level4" number="9.2.1.5">
<h4>
<span class="header-section-number">9.2.1.5</span> Stage 5 - Modify the codebase to use our GrowthStrategy<a class="anchor" aria-label="anchor" href="#modifys"><i class="fas fa-link"></i></a>
</h4>
<p>Now we have a selection of implemented <code>GrowthStrategy</code> classes, we need to modify the <code>Pet</code> subclass to utilise these new classes. To do this, we’ll add an attribute <code>growthStrategy</code> of type <code>GrowthStrategy</code> to the <code>Pet</code> class. We’ll also need to add a set method for the new attribute, and modify the existing <code>canGrow()</code> and <code>grow()</code> method in <code>Pet</code> and it’s subclasses to make calls to the new strategies.</p>
<p><strong><code>[ACTION]</code></strong> Make the remaining code changes needed to have <code>Pet</code> and its subclasses use <code>GrowthStrategy</code>. This should now mean that there is no special-case <code>grow()</code> implementation in <code>MagicDragon</code> and <code>CuddlyToy</code>. Verify that <code>PetDriver.java</code> still behaves as expected.</p>
<p>The UML diagram in figure <a href="patterning.html#fig:petstrategy-fig">9.4</a> should be a good representation of your codebase at the end of this migration task.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:petstrategy-fig"></span>
<img src="images/GrowthStrategy.png" alt="Your codebase should look something like this at the end of this migration task" width="100%"><p class="caption">
Figure 9.4: Your codebase should look something like this at the end of this migration task
</p>
</div>
</div>
</div>
<div id="state" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Exercise 1b - The State Pattern<a class="anchor" aria-label="anchor" href="#state"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of the exercise we’ll be focusing on the State pattern. You will continue to modify the <code>Pet</code> codebase.</p>
<p>In this task, you should look to apply the State pattern to store attributes related to hunger, and algorithms that depend on those attribute values.</p>
<p>Note that this is the extension/secondary task for “Exercise 1 - Behavioural Patterns”. Detailed instructions are therefore not provided, but a suggested approach might break the modification down into the following four further stages:</p>
<ol style="list-style-type: decimal">
<li>Identify hunger states and their dependant behaviours.</li>
<li>Implement an abstract <code>HungerState</code> that provides method signatures for dependant behaviours.</li>
<li>Implement a concrete implementations for each of the hunger states identified previously.</li>
<li>Modify the existing <code>Pet</code> classes to use the newly created state classes</li>
</ol>
<!--%Note that this is the extension/secondary task for ``Exercise 1 - Behavioural Patterns'' and as such, the descriptions are briefer with limited UML support.--><p>You may find it helpful to make brief UML sketches as needed as you refactor the code towards the State pattern.</p>
<!--
%\subsubsection{Stage 6 - Identify hunger states and dependant behaviours}
%\subsubsection{Stage 7 - Introduce a HungerState}
%\subsubsection{Stage 8 - Implement concrete hunger states}
%\subsubsection{Stage 9 - Modify the codebase to use our HungerState}-->
</div>
</div>
<div id="structural" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Workshop Exercise 2 - Structural Patterns<a class="anchor" aria-label="anchor" href="#structural"><i class="fas fa-link"></i></a>
</h2>
<p>This first section of the workshop focuses on applying the two Structural patterns introduced: Composite, and Adapter.</p>
<p>For this exercise, you’ll be working with a set of classes that represent habitats – places that pets might want to live. The main classes and their members can be represented in a UML class diagram in figure <a href="patterning.html#fig:habitat-fig">9.5</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:habitat-fig"></span>
<img src="images/Habitat.png" alt="Subclasses of Habitat" width="100%"><p class="caption">
Figure 9.5: Subclasses of Habitat
</p>
</div>
<p>In this workshop you’ll be extending and then refactoring the codebase to explore how structural patterns can simplify the process of adding new functionality, and can remove the need for duplicate code.</p>
<div id="composite" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Exercise 2a - The Composite Pattern<a class="anchor" aria-label="anchor" href="#composite"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of the exercise we’ll be focusing on the Composite pattern. You will modify the code in 3 stages:</p>
<ol style="list-style-type: decimal">
<li>Add new <code>Habitat</code> classes, <code>Cave</code>, <code>Field</code>, and <code>MuddyPuddle</code>
<!--%\item Consider how one might use sub-class/super-class relationships to avoid duplicate code.-->
</li>
<li>Modify <code>Habitat</code> such that it can (optionally) contain a number of child <code>Habitat</code> objects.</li>
<li>Modify the <code>describe()</code> and <code>getOccupants()</code> methods to include the values of child objects.</li>
</ol>
<div id="habitats" class="section level4" number="9.3.1.1">
<h4>
<span class="header-section-number">9.3.1.1</span> Stage 1 - Add new Habitat classes<a class="anchor" aria-label="anchor" href="#habitats"><i class="fas fa-link"></i></a>
</h4>
<p>You’ve been asked to add some new <code>Habitat</code> classes to represent more specific places that Pets might choose to spend time.
The current description for <code>MythicalCaveSystem</code> already indicates that the cave system is actually composed of three separate <code>Caves</code>.
Likewise, the <code>Farm</code> is described as containing multiple fields and a barn.</p>
<p>You’ve been asked to add three specific new Habitat classes:</p>
<ul>
<li>
<code>Cave</code> - A single cave for dragons to hide in.</li>
<li>
<code>Field</code> - A field with grass that goats might eat.</li>
<li>
<code>MuddyPuddle</code> - A patch of muddy water – goats love splashing in puddles.</li>
</ul>
<p><strong><code>[ACTION]</code></strong> Implement three new <code>Habitat</code> subclass as above, and modify <code>HabitatDriver.java</code> to demonstrate your new <code>Habitat</code> subtypes.</p>
</div>
<div id="children" class="section level4" number="9.3.1.2">
<h4>
<span class="header-section-number">9.3.1.2</span> Stage 2 - Modify Habitat to contain child Habitat objects<a class="anchor" aria-label="anchor" href="#children"><i class="fas fa-link"></i></a>
</h4>
<p>We already know that <code>MythicalCaveSystem</code> contains three <code>Caves</code>, and that <code>Farm</code> contains a <code>Field</code>. We’re going to use the Composite pattern to make this relationship an integral part of our class structure.</p>
<p>To start this refactoring, you’ll need to modify <code>Habitat</code> to have a list of children; children should be of type <code>Habitat</code>.</p>
<p><strong><code>[ACTION]</code></strong> Modify the <code>Habitat</code> class to add the new element.</p>
<p><strong><code>[ACTION]</code></strong> Create new methods to add, remove and get children to a <code>Habitat</code>.</p>
<p><strong><code>[ACTION]</code></strong> Modify <code>HabitatDriver</code> to demonstrate that multiple <code>Caves</code> objects can be added as a child of a <code>MythicalCaveSystem</code>, and that a <code>Field</code> can be added as the child of a <code>Farm</code>.</p>
<p><strong><code>[ACTION]</code></strong> Modify <code>HabitatDriver</code> to demonstrate that an instance of <code>MuddyPuddle</code> can be added as a child of the <code>Field</code> (which is itself a child of <code>Farm</code>).</p>
</div>
<div id="childmethods" class="section level4" number="9.3.1.3">
<h4>
<span class="header-section-number">9.3.1.3</span> Stage 3 - Modify Habitat to call child methods<a class="anchor" aria-label="anchor" href="#childmethods"><i class="fas fa-link"></i></a>
</h4>
<p>The final stage of our refactoring is to make sure that the descriptions of each <code>Habitat</code> are as complete as possible, and that the occupancy counts are correct (i.e. they include occupants in any part of the <code>Habitat</code>). To do this, we need to make sure that the <code>describe()</code> and <code>getOccupants()</code> of <code>Habitat</code> recursively call the same methods on any children.</p>
<p><strong><code>[ACTION]</code></strong> Modify <code>describe()</code> to recursively call <code>childHabitat.describe()</code> for every <code>childHabitat</code> in the list of children for this habitat. You will need to store the result and build a new formatted description string in the parent.</p>
<p><strong><code>[ACTION]</code></strong> Modify <code>getOccupants()</code> to recursively call <code>childHabitat.getOccupants()</code> for every <code>childHabitat</code> in the list of children for this habitat. You will need to store the result to build one complete list of every <code>Pet</code> in parts of the top-level <code>Habitat</code>.</p>
<p><strong><code>[ACTION]</code></strong> Modify <code>HabitatDriver</code> to demonstrate that your new <code>describe()</code> and <code>getOccupants()</code> methods work as expected. In particular you should confirm that:</p>
<ul>
<li>A call to <code>aMuddyPuddle.describe()</code> shows only the description for the <code>MuddyPuddle</code>.</li>
<li>A call to <code>aField.describe()</code> shows the description for the <code>Field</code> and the <code>MuddyPuddle</code>.</li>
<li>A call to <code>theFarm.describe()</code> shows the description for the <code>Farm</code>, the <code>Field</code> and the <code>MuddyPuddle</code>.</li>
</ul>
<p>Likewise, you should check calls to <code>getOccupants()</code> for each of the above, and check both <code>describe()</code> and <code>getOccupants()</code> for <code>theCaves</code> and <code>aCave</code>.</p>
<p><strong><code>[OPTIONAL EXTRA]</code></strong> Modify <code>removeOccupant()</code> to remove an Occupant from this child <code>Habitats</code> if they aren’t found in the parent.</p>
<p>The UML diagram in figure <a href="patterning.html#fig:composite-fig">9.6</a> should be a good representation of your codebase at the end of this migration task.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:composite-fig"></span>
<img src="images/HabitatComposite.png" alt="Your codebase should look something like this at the end of this migration task" width="100%"><p class="caption">
Figure 9.6: Your codebase should look something like this at the end of this migration task
</p>
</div>
</div>
</div>
<div id="adapter" class="section level3" number="9.3.2">
<h3>
<span class="header-section-number">9.3.2</span> Exercise 2b - The Adapter Pattern<a class="anchor" aria-label="anchor" href="#adapter"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of the exercise we’ll be focusing on the Adapter pattern. You will continue to modify the <code>Habitat</code> codebase.</p>
<p>In this task, you should look to apply the Adapter pattern to make a legacy class <code>FieryMountains.java</code> available as a possible <code>Habitat</code>.
<code>FieryMountains</code> was implemented many years ago for a previous game but has lots of neat graphics that the team want to reuse. You should use the Adapter pattern to <code>FieryMountains</code> to be used as is, as a new <code>Habitat</code>. You absolutely must not modify <code>FieryMountains.java</code>, and it must be used in your final solution (i.e. you can’t just copy and paste a few values out and then just ignore it).</p>
<p>Note that this is the extension/secondary task for “Exercise 2 - Structural Patterns”. Detailed instructions are therefore not provided, but a suggested approach might break the modification down into the following four further stages:</p>
<ol style="list-style-type: decimal">
<li>Create a new Java stub <code>FieryMountainsAdapter</code> that extends Habitat and stores a new <code>FieryMountains</code> instance as one of its attributes.</li>
<li>Write a new implementation for <code>FieryMountainsAdapter.describe()</code>, that complies with the signature provided for this method in <code>Habitat</code> and calls relevant functionality from <code>FieryMountains</code>.</li>
<li>Modify <code>HabitatDriver</code> to demonstrate that fiery mountains can be added to the <code>ArrayList</code> of Habitats, and that <code>Pet</code> instances (maybe a <code>Dragon</code>?) can be added as an occupant of <code>FieryMountains</code>.</li>
</ol>
<p>You may find it helpful to make brief UML sketches as needed as you refactor the code towards the Adapter pattern.</p>
<!--
%\subsubsection{Stage 4 - Add a new FieryMountainsAdapter class}
%\subsubsection{Stage 5 - Implement describe}
%\subsubsection{Stage 6 - Modify the driver}-->
</div>
</div>
<div id="creational" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Workshop Exercise 3 - Creational Patterns<a class="anchor" aria-label="anchor" href="#creational"><i class="fas fa-link"></i></a>
</h2>
<p>This first section of the workshop focuses on applying the two Creational patterns introduced: Factory Method, and Singleton.</p>
<p>These two patterns should be more familiar to you, from your experiences in this and other courses. For example, you’ve previously looked at Stendhal’s own <code>Singleton</code> class <code>RPWorld</code> in one of the early workshops.</p>
<p>For this exercise, you’ll be working with the <code>Pet</code> and <code>Habitat</code> classes you’ve already seen. This time we’re using these classes together as part of a <code>Tamagotchi</code> application – a simple text based application that lets users look after a virtual pet for a while.</p>
<p>In this workshop you’ll be extending and then refactoring the codebase to explore how creational patterns can allow users to control instantiation of <code>Pets</code> and <code>Habitats</code>.</p>
<div id="factory" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> Exercise 3a - The Factory Method<a class="anchor" aria-label="anchor" href="#factory"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of the exercise we’ll be refactoring the Factory Method to instantiate different <code>Pet</code> and <code>Habitat</code> classes at runtime<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Note that it would also be possible to achieve this using Reflection, but in this case we’ll be demonstrating how a Factory Method might be applied.&lt;/p&gt;"><sup>1</sup></a></p>
<p>This is a much simpler change than previous changes, and can most likely be achieved in 3 stages:</p>
<ol style="list-style-type: decimal">
<li>Add a new <code>PetCreator</code> class that creates <code>Pet</code> objects in response to a <code>String</code> parameter.</li>
<li>Add a new <code>HabitatCreator</code> class that creates <code>Habitat</code> objects in response to a <code>String</code> parameter.</li>
<li>Modify the <code>Tamagotchi</code> class to use the new classes, passing user input in as the <code>String</code> parameters.</li>
</ol>
<p>You should now be able to carry out these changes without the more detailed instructions of previous exercises.</p>
</div>
<div id="singleton" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> Exercise 3b - The Singleton Pattern<a class="anchor" aria-label="anchor" href="#singleton"><i class="fas fa-link"></i></a>
</h3>
<p>In this final part of the exercise you should consider if there is a sensible application of the Singleton pattern in any of the application code you have worked with in today’s exercises.</p>
<p><code>Document version:</code> 04 July, 2022</p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="designing.html"><span class="header-section-number">8</span> Design for Testability</a></div>
<div class="next"><a href="risking.html"><span class="header-section-number">10</span> Risk management</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#patterning"><span class="header-section-number">9</span> Software design patterns</a></li>
<li><a class="nav-link" href="#introduction"><span class="header-section-number">9.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#behave"><span class="header-section-number">9.2</span> Workshop Exercise 1 - Behavioural Patterns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#strategy"><span class="header-section-number">9.2.1</span> Exercise 1a - The Strategy Pattern</a></li>
<li><a class="nav-link" href="#state"><span class="header-section-number">9.2.2</span> Exercise 1b - The State Pattern</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#structural"><span class="header-section-number">9.3</span> Workshop Exercise 2 - Structural Patterns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#composite"><span class="header-section-number">9.3.1</span> Exercise 2a - The Composite Pattern</a></li>
<li><a class="nav-link" href="#adapter"><span class="header-section-number">9.3.2</span> Exercise 2b - The Adapter Pattern</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#creational"><span class="header-section-number">9.4</span> Workshop Exercise 3 - Creational Patterns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#factory"><span class="header-section-number">9.4.1</span> Exercise 3a - The Factory Method</a></li>
<li><a class="nav-link" href="#singleton"><span class="header-section-number">9.4.2</span> Exercise 3b - The Singleton Pattern</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/dullhunk/softeng/blob/master/09-patterning.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/dullhunk/softeng/edit/master/09-patterning.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software engineering</strong>" was written by Suzanne Embury and the software engineering team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
